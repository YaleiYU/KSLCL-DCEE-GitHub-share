%% Plot Function

close all;
clear;
clc;

%%
set(groot, 'defaulttextinterpreter','latex');  
set(groot, 'defaultAxesTickLabelInterpreter','latex');  
set(groot, 'defaultLegendInterpreter','latex');
set(0, 'defaultFigureUnits', 'centimeters', 'defaultFigurePosition', [0 0 16 9]);

%%
filenames={
           'Reward_store_dcee.mat', 'theta_store_dcee.mat', 'x_k_store_dcee.mat', 'y_k_store_dcee.mat', 'xi_k_store_dcee.mat' ...
           'Reward_store_lksdcee_n5.mat','theta_store_lksdcee_n5.mat','x_k_store_lksdcee_n5.mat','y_k_store_lksdcee_n5.mat', 'xi_k_store_lksdcee_n5.mat' ...
           'Reward_store_lksdcee_n8.mat','theta_store_lksdcee_n8.mat','x_k_store_lksdcee_n8.mat','y_k_store_lksdcee_n8.mat', 'xi_k_store_lksdcee_n8.mat', ...
           'Reward_store_lksdcee_n8_oglr.mat','theta_store_lksdcee_n8_oglr.mat','x_k_store_lksdcee_n8_oglr.mat','y_k_store_lksdcee_n8_oglr.mat', 'xi_k_store_lksdcee_n8_oglr.mat', ...
           'Reward_store_lksdcee_n12.mat','theta_store_lksdcee_n12.mat','x_k_store_lksdcee_n12.mat','y_k_store_lksdcee_n12.mat', 'xi_k_store_lksdcee_n12.mat', ...
          };
 
 for kk=1:numel(filenames)
     load(filenames{kk})
 end
 

%% 
thetaMean_dcee = mean(theta_store_dcee);
thetaVariance_dcee = var(theta_store_dcee);
std_dev_dcee = sqrt(thetaVariance_dcee);

thetaMean_lksdcee_n5 = mean(theta_store_lksdcee_n5);
thetaVariance_lksdcee_n5 = var(theta_store_lksdcee_n5);
std_dev_lksdcee_n5 = sqrt(thetaVariance_lksdcee_n5);

thetaMean_lksdcee_n8 = mean(theta_store_lksdcee_n8);
thetaVariance_lksdcee_n8 = var(theta_store_lksdcee_n8);
std_dev_lksdcee_n8 = sqrt(thetaVariance_lksdcee_n8);

thetaMean_lksdcee_n8_oglr = mean(theta_store_lksdcee_n8_oglr);
thetaVariance_lksdcee_n8_oglr = var(theta_store_lksdcee_n8_oglr);
std_dev_lksdcee_n8_oglr = sqrt(thetaVariance_lksdcee_n8_oglr);

thetaMean_lksdcee_n12 = mean(theta_store_lksdcee_n12);
thetaVariance_lksdcee_n12 = var(theta_store_lksdcee_n12);
std_dev_lksdcee_n12 = sqrt(thetaVariance_lksdcee_n12);

T1 = 80;


%% 
figure(1)
t1=1:1:T1;
patch([t1 fliplr(t1)], [thetaMean_dcee-std_dev_dcee  fliplr(thetaMean_dcee+std_dev_dcee)], [0.3010, 0.7450, 0.9330])
hold on
patch([t1 fliplr(t1)], [thetaMean_lksdcee_n8_oglr-std_dev_lksdcee_n8_oglr  fliplr(thetaMean_lksdcee_n8_oglr+std_dev_lksdcee_n8_oglr)], [0, 1, 0])
hold on 
patch([t1 fliplr(t1)], [thetaMean_lksdcee_n5-std_dev_lksdcee_n5  fliplr(thetaMean_lksdcee_n5+std_dev_lksdcee_n5)], [0.3010, 0.0, 0.0])
hold on
patch([t1 fliplr(t1)], [thetaMean_lksdcee_n8-std_dev_lksdcee_n8  fliplr(thetaMean_lksdcee_n8+std_dev_lksdcee_n8)], [1, 0, 0])
hold on 
patch([t1 fliplr(t1)], [thetaMean_lksdcee_n12-std_dev_lksdcee_n12  fliplr(thetaMean_lksdcee_n12+std_dev_lksdcee_n12)], [0.9290, 0.6940, 0.1250])
hold on 
plot(t1, thetaMean_dcee,'--r',   ...
     t1, thetaMean_lksdcee_n8_oglr,'-.m', ...
     t1, thetaMean_lksdcee_n5,'--k', ...
     t1, thetaMean_lksdcee_n8,'-. b',  ...
     t1, thetaMean_lksdcee_n12,': c',  ...
     t1, ones(T1,1), '- g', 'LineWidth',1.5 ...
    );
box on
xlim([0,T1]);
my_legend = legend('$ \bar{\Theta}_n \pm \sigma_n,$ DCEE [6]', ...
                   '$ \bar{\Theta}_n \pm \sigma_n, k=8, \eta_\tau=\eta $', ...
                   '$ \bar{\Theta}_n \pm \sigma_n, k=5 $', ...
                   '$ \bar{\Theta}_n \pm \sigma_n, k=8 $', ...
                   '$ \bar{\Theta}_n \pm \sigma_n, k=12$', ...
                   '$ \bar{\Theta}_n, k=1 $', ...
                   '$ \bar{\Theta}_n, k=8, \eta_\tau=\eta $', ...
                   '$ \bar{\Theta}_n, k=5 $', ...
                   '$ \bar{\Theta}_n, k=8 $', ...
                   '$ \bar{\Theta}_n, k=12 $',  'Ground truth $\Theta$');
set(my_legend,'FontSize', 12, 'NumColumns', 2);
xlabel('$ n $','FontSize', 12);
ylabel('$ \bar{\Theta}_n $','FontSize', 12);


figure(2)
plot(t1, y_k_store_dcee, '--r', ... 
     t1, y_k_store_lksdcee_n8_oglr, '-.m', ...
     t1, y_k_store_lksdcee_n5, '--k', ...
     t1, y_k_store_lksdcee_n8, '-. b', ...
     t1, y_k_store_lksdcee_n12, ': c', ...
     t1, 1*ones(T1,1), '-g', ...
    'LineWidth',1.5)
xlim([0,T1]);
my_legend = legend('$ y_n,$ DCEE [6]', ...
                   '$ y_n, k=8, \eta_\tau=\eta $', '$ y_n, k=5 $', '$ y_n, k=8 $', ...
                   '$ y_n, k=12 $', ' Optimal reference ');
set(my_legend, 'FontSize', 12);
my_legend.NumColumns=2;
xlabel('$ n $', 'FontSize', 12);
ylabel('$ y_n $', 'FontSize', 12);


figure(3)
plot(t1, Reward_store_dcee, '--r ', ...
     t1, Reward_store_lksdcee_n8_oglr, '-.m', ...
     t1, Reward_store_lksdcee_n5, '-- k', ...
     t1, Reward_store_lksdcee_n8, '-. b', ...
     t1, Reward_store_lksdcee_n12, ': c', ...
     t1, 1*ones(T1,1), ' -g ', ...
    'LineWidth',1.5)
xlim([0,T1]);
my_legend = legend('Observed reward, $ z(y_n, \Theta),$ DCEE [6]', ...
                   'Observed reward, $ z(y_n, \Theta), k=8, \eta_\tau=\eta $', ...
                   'Observed reward, $ z(y_n, \Theta), k=5 $', ...
                   'Observed reward, $ z(y_n, \Theta), k=8 $', 'Observed reward, $ z(y_n, \Theta), k=12 $', ...
                   'Optimal reward', 'Location', 'southeast');
set(my_legend,'FontSize', 12);
xlabel('$ n $','FontSize', 12);
ylabel('$ z(y_n, \Theta) $','FontSize', 12);


figure(4)
plot(t1, xi_k_store_dcee, '--r', ... 
     t1, xi_k_store_lksdcee_n8_oglr, '-. m', ...
     t1, xi_k_store_lksdcee_n5, '--k', ...
     t1, xi_k_store_lksdcee_n8, '-. b', ...
     t1, xi_k_store_lksdcee_n12, ': c', ...
     t1, 1*ones(T1,1), '-g', ...
    'LineWidth',1.5)
xlim([0,T1]);
my_legend = legend('$ {\xi}_n, $ DCEE [6]',  ...
                   '$ {\xi}_n, k=8, \eta_\tau=\eta $', '$ {\xi}_n, k=5 $', '$ {\xi}_n, k=8 $', ...
                   '$ {\xi}_n, k=12 $', ' Optimal reference ');
set(my_legend, 'FontSize', 12, 'Location', 'southeast');
my_legend.NumColumns=2;
xlabel('$ n $', 'FontSize', 12);
ylabel('$ {\xi}_n $', 'FontSize', 12);

